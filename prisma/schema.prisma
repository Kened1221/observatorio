// Configuración del datasource (base de datos)
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Generador para el cliente de Prisma
generator client {
  provider = "prisma-client-js"
}

// Modelo: Departamento
model Departamento {
  id         Int         @id @default(autoincrement())
  nombre     String      @unique @db.VarChar(100)
  provincias Provincia[] // Relación uno a muchos con Provincia
  encuestas  Encuesta[] // Relación uno a muchos con Encuesta
}

// Modelo: Provincia
model Provincia {
  id             Int          @id @default(autoincrement())
  nombre         String       @db.VarChar(100)
  departamentoId Int          @map("departamento_id")
  departamento   Departamento @relation(fields: [departamentoId], references: [id], onDelete: Cascade)
  distritos      Distrito[] // Relación uno a muchos con Distrito
  encuestas      Encuesta[] // Relación uno a muchos con Encuesta
}

// Modelo: Distrito
model Distrito {
  id          Int        @id @default(autoincrement())
  nombre      String     @db.VarChar(100)
  provinciaId Int        @map("provincia_id")
  provincia   Provincia  @relation(fields: [provinciaId], references: [id], onDelete: Cascade)
  encuestas   Encuesta[] // Relación uno a muchos con Encuesta
}

// Modelo: Encuesta
model Encuesta {
  id             Int          @id @default(autoincrement())
  departamentoId Int          @map("departamento_id")
  provinciaId    Int          @map("provincia_id")
  distritoId     Int          @map("distrito_id")
  rangoId        Int          @map("rango_id")
  departamento   Departamento @relation(fields: [departamentoId], references: [id], onDelete: Cascade)
  provincia      Provincia    @relation(fields: [provinciaId], references: [id], onDelete: Cascade)
  distrito       Distrito     @relation(fields: [distritoId], references: [id], onDelete: Cascade)
  rango          Rango        @relation(fields: [rangoId], references: [id], onDelete: Cascade)
}

// Modelo: Rango
model Rango {
  id          Int @id @default(autoincrement())
  edadId      Int @map("edad_id")
  poblacionId Int @map("poblacion_id")
  ambitoId    Int @map("ambito_ident")

  encuestas Encuesta[] // Relación uno a muchos con Encuesta
  poblacion Poblacion[] // Relación uno a muchos con Encuesta
  Ambito    Ambito[] // Relación uno a muchos con Encuesta
  Edad      Edad        @relation(fields: [edadId], references: [id])
}

// Modelo: Edad
model Edad {
  id            Int     @id @default(autoincrement())
  edadIntervalo String
  rangos        Rango[]
}

// Modelo: Poblacion
model Poblacion {
  id      Int   @id @default(autoincrement())
  hombres Int
  mujeres Int
  rangoId Int   @map("rango_id")
  rango   Rango @relation(fields: [rangoId], references: [id], onDelete: Cascade)
}

// Modelo: Ambito
model Ambito {
  id      Int   @id @default(autoincrement())
  rural   Int
  urbano  Int
  rangoId Int   @map("rango_id")
  rango   Rango @relation(fields: [rangoId], references: [id], onDelete: Cascade)
}
